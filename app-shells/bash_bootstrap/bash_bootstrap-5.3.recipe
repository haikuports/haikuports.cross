SUMMARY="The GNU Bourne Again Shell"
DESCRIPTION="Bash is an sh-compatible command language interpreter that \
executes commands read from the standard input or from a file. Bash also \
incorporates useful features from the Korn and C shells (ksh and csh)."
HOMEPAGE="https://www.gnu.org/software/bash/"
COPYRIGHT="1987-2024 Free Software Foundation, Inc."
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="https://mirrors.dotsrc.org/ftp.gnu.org/gnu/bash/bash-5.3.tar.gz"
CHECKSUM_SHA256="0d5cd86965f869a26cf64f4b71be7b96f90a3ba8b3d74e27e8e9d9d5550f31ba"

SOURCE_DIR="bash-5.3"
PATCHES="
	bash-5.0.patchset
	bash-5.3.patchset
	"

ARCHITECTURES="arm"

PROVIDES="
	bash_bootstrap = $portVersion
	cmd:bash = $portVersion
	cmd:bashbug = $portVersion
	cmd:sh
	"
REQUIRES="
	haiku
	lib:libncursesw
	"

BUILD_REQUIRES="
	haiku_devel
	devel:libncursesw
	"
BUILD_PREREQUIRES="
	cmd:awk
	cmd:bison
	cmd:cmp
	cmd:gcc
	cmd:make
	cmd:sed
	"

BUILD()
{
	runConfigure ./configure \
		--without-bash-malloc --build=$buildMachineTriple --host=$targetMachineTriple
	# plural needs a later timestamp per http://savannah.gnu.org/support/?109469
	# since it doesn't work with bison 3.0
	touch lib/intl/plural.c
	make $jobArgs
}

INSTALL()
{
	make DESTDIR=$installDestDir install
	ln -s bash $installDestDir$binDir/sh
}
