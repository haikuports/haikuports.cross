SUMMARY="Standard GNU documentation format tool"
DESCRIPTION="Texinfo is the official documentation format of the GNU project."
HOMEPAGE="http://www.gnu.org/software/texinfo/"
COPYRIGHT="1992-2023 Free Software Foundation, Inc."
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="http://ftp.gnu.org/gnu/texinfo/texinfo-$portVersion.tar.gz"
CHECKSUM_SHA256="e86de7dfef6b352aa1bf647de3a6213d1567c70129eccbf8977706d9c91919c8"
PATCHES="texinfo_bootstrap-$portVersion.patchset"
SOURCE_DIR="texinfo-$portVersion"

ARCHITECTURES="arm64"

portVersionCompat="$portVersion compat >= ${portVersion%%.*}"

PROVIDES="
	texinfo_bootstrap = $portVersionCompat
	texinfo = $portVersionCompat
	cmd:info = $portVersionCompat
	cmd:infokey = $portVersionCompat
	cmd:install_info = $portVersionCompat
	cmd:makeinfo = $portVersionCompat
	cmd:pdftexi2dvi = $portVersionCompat
	cmd:pod2texi = $portVersionCompat
	cmd:texi2any = $portVersionCompat
	cmd:texi2dvi = $portVersionCompat
	cmd:texi2pdf = $portVersionCompat
	cmd:texindex = $portVersionCompat
	"
REQUIRES="
	haiku
	lib:libncurses
	"

BUILD_REQUIRES="
	devel:libncurses
	"
BUILD_PREREQUIRES="
	haiku_devel
	binutils_cross_$targetArchitecture
	gcc_cross_$targetArchitecture
	cmd:${targetMachineTripleAsName}_libtoolize
	cmd:gcc
	cmd:ld
	cmd:make
	cmd:sed
	"

BUILD()
{
	${targetMachineTriple}-libtoolize --force --copy --install
	mkdir -p build
	cd build
	CFLAGS="-fPIC -O1" runConfigure ../configure \
		--build=$buildMachineTriple --host=$targetMachineTriple --enable-perl-xs=no
	
	make -C tools/gnulib/lib
	make -C tools
	make
}

INSTALL()
{
	cd build
	make DESTDIR=$installDestDir install
}
